define("fenda:src/page/layout/base",["unicorn/user","unicorn/log"],function(i,o,n){var t=i("unicorn/user"),e=i("unicorn/log"),a=jsmod.util.klass({initialize:function(o){var n=this;this.option=o,window.FastClick.attach(document.body),$(".common-img-lazy").each(function(){jsmod.util.lazy.add(this)}),this.headerEvent(),this.serchInput(),this.initScrollTop(),this.initAjax(),this.initFooterAction(),this.initLinkClick(),i.async(["http://res.wx.qq.com/open/js/jweixin-1.0.0.js"],function(i){wx=i,n.initWx()})},initWx:function(){var i=this;$.ajax({url:"/api/wx_config/?url="+encodeURIComponent(window.location.href),dataType:"json",success:function(o){var n=$.extend({},i.option.wxConfig,o);delete n.url,wx.config(n),wx.ready(function(){i.initWxShare()}),wx.error(function(){})}})},initWxShare:function(){var i="http://image.sellergrowth.com/images%2Flogo300.png";this.option.wxShare.success=function(){var i=jsmod.util.url.getParam(window.location.href,"ch"),o=jsmod.util.url.getParam(window.location.href,"inviter_uid");i&&o&&$.ajax({url:"/api/event/api/wechat_forward/",type:"post",dataType:"json",contentType:"application/json",processData:!1,data:{ch:i,inviter_uid:o}})},wx.onMenuShareAppMessage(this.option.wxShare);var o=this.option.wxShare.title.replace("卖家成长-","")==this.option.wxShare.desc?"":this.option.wxShare.desc;wx.onMenuShareTimeline($.extend({},this.option.wxShare,{imgUrl:this.option.wxShare.imgUrlTimeline||i,title:"【"+this.option.wxShare.title.replace("卖家成长-","")+"】"+o}))},initFooterAction:function(){$(".footer-action .seller-login").on("click",function(){t.login()}),$(".footer-action .seller-register").on("click",function(){t.register()})},initAjax:function(){$(document).on("ajaxBeforeSend",function(i,o,n){n.dataType="json",/^(GET|HEAD|OPTIONS|TRACE)$/.test(n.type)||(o.setRequestHeader("X-CSRFToken",jsmod.util.cookie.getRaw("csrftoken")),n.data&&(n.data=JSON.stringify(n.data)))})},initScrollTop:function(){var i=$(".seller-right-fixed .action-top").on("click",function(){window.scroll(0,0)}),o=$(".seller-right-fixed .action-about");$(window).on("scroll",function(){var n=$(window).height(),t=$(window).scrollTop();t>n?(i.css("display","block"),o.css("display","block")):(i.css("display","none"),o.css("display","none"))})},headerEvent:function(){var i=$(".seller-header");i.on("click",".seller-logout-action",function(){$.ajax({url:"/api/accounts/api/account_logout/",dataType:"json",success:function(){window.location.reload()}})}),i.on("click",".seller-action-back",function(){window.history.length<=1||"login"==jsmod.util.url.getParam(window.location.href,"_s")?window.location.href="/":window.history.go(-1)}),i.on("click",".seller-nav-action",function(){$mask=$(".seller-mask"),$mask.length||($mask=$("<div class='seller-mask'></div>"),$("body").append($mask)),$mask.show(),setTimeout(function(){i.find(".seller-nav-list").show()},100)}),$(document).on("click",".seller-mask",function(){$(".seller-mask").hide(),i.find(".seller-nav-list").hide()})},serchInput:function(){var i=$("#search"),o=$(".seller-footer-fixed"),n=$(".seller-search .icon-circle-cross");i.on("focus",function(){i.prop("placeholder",""),o.hide(),n.show()}).on("blur",function(){i.prop("placeholder","请输入要搜索的内容"),o.show(),n.hide()}),n.on("tap",function(){i.val("")}),$(".input-wrap form").on("submit",function(){return i.val()?void 0:!1})},initLinkClick:function(){$("body").delegate("a","click",function(){var i=$(this).prop("href"),o=$(this).prop("target"),n=e.getLink(i);return n?("_blank"==o?window.open(n):window.location.href=n,!1):void 0})}});n.exports=a});